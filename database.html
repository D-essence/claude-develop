<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>データベース構築 | AI駆動Web開発ポータル</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@300;400;500;700&family=Kosugi+Maru&family=Caveat&family=Fira+Code:wght@400;500&display=swap');
        
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
            --warning: #fca311;
            --info: #7209b7;
            --bg-light: #f8f9fa;
            --bg-dark: #343a40;
            --code-bg: #f5f5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: var(--bg-light);
            background-image: 
                radial-gradient(#e3e3e3 1px, transparent 1px),
                radial-gradient(#e3e3e3 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            padding-bottom: 50px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background-color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid var(--primary);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: var(--primary);
        }
        
        .logo h1 {
            font-family: 'Kosugi Maru', sans-serif;
            font-size: 1.8rem;
            margin-left: 10px;
        }
        
        .logo-icon {
            font-size: 2rem;
            color: var(--accent);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            position: relative;
            padding: 5px 0;
            transition: color 0.3s;
        }
        
        nav a:hover {
            color: var(--primary);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary);
            transition: width 0.3s;
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        .page-header {
            background-color: white;
            padding: 60px 0;
            text-align: center;
            border-radius: 12px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234361ee' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .page-header h2 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .page-header p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            color: #666;
        }
        
        .section {
            padding: 60px 0;
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .section-header h2 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }
        
        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: var(--accent);
        }
        
        .section-header p {
            font-size: 1.1rem;
            color: #666;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 30px;
            margin-top: 50px;
        }
        
        .sidebar {
            position: sticky;
            top: 100px;
            height: fit-content;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 20px;
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .sidebar-nav {
            list-style: none;
        }
        
        .sidebar-nav li {
            margin-bottom: 10px;
        }
        
        .sidebar-nav a {
            text-decoration: none;
            color: var(--dark);
            display: block;
            padding: 8px 10px;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .sidebar-nav a:hover {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .sidebar-nav a.active {
            background-color: var(--primary);
            color: white;
        }
        
        .main-content {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 40px;
        }
        
        .content-section {
            margin-bottom: 50px;
        }
        
        .content-section:last-child {
            margin-bottom: 0;
        }
        
        .content-section h3 {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .content-section h4 {
            font-size: 1.4rem;
            color: var(--secondary);
            margin: 30px 0 15px;
        }
        
        .content-section h5 {
            font-size: 1.2rem;
            color: var(--dark);
            margin: 20px 0 10px;
        }
        
        .content-section p {
            margin-bottom: 15px;
        }
        
        .content-section ul, .content-section ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        
        .content-section li {
            margin-bottom: 8px;
        }
        
        .handdrawn {
            position: relative;
            font-family: 'Caveat', cursive;
            font-size: 1.3em;
            color: var(--accent);
        }
        
        .code-block {
            background-color: var(--code-bg);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            position: relative;
        }
        
        .code-block::before {
            content: attr(data-language);
            position: absolute;
            top: 0;
            right: 0;
            background-color: rgba(0,0,0,0.1);
            padding: 2px 10px;
            font-size: 0.7rem;
            border-radius: 0 8px 0 8px;
            text-transform: uppercase;
        }
        
        .notes {
            background-color: rgba(252, 163, 17, 0.1);
            border-left: 3px solid var(--warning);
            padding: 15px;
            border-radius: 0 5px 5px 0;
            margin: 20px 0;
        }
        
        .notes h4 {
            color: var(--warning);
            margin-bottom: 10px;
            margin-top: 0;
            font-size: 1.1rem;
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .tip {
            background-color: rgba(76, 201, 240, 0.1);
            border-left: 3px solid var(--success);
            padding: 15px;
            border-radius: 0 5px 5px 0;
            margin: 20px 0;
        }
        
        .tip h4 {
            color: var(--success);
            margin-bottom: 10px;
            margin-top: 0;
            font-size: 1.1rem;
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .prompt-example {
            background-color: rgba(67, 97, 238, 0.05);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 0.9rem;
            position: relative;
        }
        
        .prompt-example::before {
            content: 'プロンプト例';
            position: absolute;
            top: -12px;
            left: 15px;
            background-color: white;
            padding: 0 10px;
            font-size: 0.8rem;
            color: var(--primary);
            border-radius: 4px;
            border: 1px solid rgba(67, 97, 238, 0.2);
            font-family: 'M PLUS Rounded 1c', sans-serif;
        }
        
        .service-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        }
        
        .service-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            flex-shrink: 0;
        }
        
        .service-content {
            flex-grow: 1;
        }
        
        .service-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .comparison-table th {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            font-weight: 500;
        }
        
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        
        .comparison-table tr:hover td {
            background-color: rgba(67, 97, 238, 0.05);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .feature-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .steps-container {
            position: relative;
            margin: 40px 0;
            padding-left: 30px;
        }
        
        .steps-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 15px;
            height: 100%;
            width: 2px;
            background-color: #eee;
        }
        
        .step-item {
            position: relative;
            margin-bottom: 30px;
        }
        
        .step-item:last-child {
            margin-bottom: 0;
        }
        
        .step-number {
            position: absolute;
            left: -30px;
            top: 0;
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }
        
        .step-content {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border-left: 3px solid var(--primary);
        }
        
        .step-title {
            font-size: 1.2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .db-model-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .db-model-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .db-model-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            margin-right: 10px;
        }
        
        .db-model-title {
            font-size: 1.3rem;
            color: var(--primary);
            margin: 0;
        }
        
        .db-model-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .db-table {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            flex: 1 0 200px;
        }
        
        .db-table-header {
            background-color: var(--primary);
            color: white;
            padding: 8px 10px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .db-field {
            padding: 6px 10px;
            border-bottom: 1px solid #eee;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
        }
        
        .db-field:last-child {
            border-bottom: none;
        }
        
        .db-primary-key {
            font-weight: 700;
            color: var(--primary);
        }
        
        .db-foreign-key {
            font-weight: 500;
            color: var(--accent);
        }
        
        .db-relation {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        
        .db-relation-line {
            width: 100px;
            height: 2px;
            background-color: var(--accent);
            position: relative;
        }
        
        .db-relation-line::before,
        .db-relation-line::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--accent);
            top: 50%;
            transform: translateY(-50%);
        }
        
        .db-relation-line::before {
            left: 0;
        }
        
        .db-relation-line::after {
            right: 0;
        }
        
        .db-relation-text {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            color: var(--accent);
            white-space: nowrap;
        }
        
        .gr-container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 30px;
            margin: 30px 0;
            position: relative;
        }
        
        .gr-title {
            text-align: center;
            font-family: 'Caveat', cursive;
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 30px;
        }
        
        .gr-content {
            position: relative;
        }
        
        footer {
            background-color: var(--dark);
            color: white;
            padding: 40px 0;
            text-align: center;
        }
        
        .footer-content {
            max-width: 700px;
            margin: 0 auto;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        
        .footer-links a {
            color: white;
            margin: 0 15px;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        
        .footer-links a:hover {
            opacity: 1;
        }
        
        /* メディアクエリ */
        @media (max-width: 991px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
                margin-bottom: 30px;
            }
            
            .sidebar-nav {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .sidebar-nav li {
                margin-bottom: 0;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .service-card {
                flex-direction: column;
                text-align: center;
            }
            
            .service-icon {
                margin: 0 auto;
            }
            
            .db-model-content {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <div class="logo-icon">🚀</div>
                    <h1>AI駆動Web開発ポータル</h1>
                </a>
                <nav>
                    <ul>
                        <li><a href="index.html">ホーム</a></li>
                        <li><a href="development-flow.html">開発フロー</a></li>
                        <li><a href="frontend.html">フロントエンド</a></li>
                        <li><a href="backend.html">バックエンド</a></li>
                        <li><a href="database.html">データベース</a></li>
                        <li><a href="prompts.html">プロンプト集</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    
    <main class="container">
        <section class="page-header">
            <h2>データベース構築ガイド</h2>
            <p>非エンジニアがClaude3.7を活用してWebサービスのデータベースを設計・構築する方法を解説します</p>
        </section>
        
        <section class="section">
            <div class="section-header">
                <h2>データベースの基本概念</h2>
                <p>Webサービスの中核を担うデータの保存・管理システム</p>
            </div>
            
            <div class="gr-container">
                <h3 class="gr-title">データベースとは？</h3>
                <div class="gr-content">
                    <svg viewBox="0 0 1000 500" width="100%" height="auto">
                        <!-- 背景グリッド -->
                        <defs>
                            <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">
                                <path d="M 10 0 L 0 0 0 10" fill="none" stroke="#f0f0f0" stroke-width="0.5"/>
                            </pattern>
                            <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">
                                <rect width="100" height="100" fill="url(#smallGrid)"/>
                                <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                            </pattern>
                        </defs>
                        <rect width="100%" height="100%" fill="url(#grid)" />
                        
                        <!-- データベースの中心図 -->
                        <circle cx="500" cy="250" r="150" fill="#f0f4c3" stroke="#2a9d8f" stroke-width="3"/>
                        <text x="500" y="250" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="24" fill="#2a9d8f">データベース</text>
                        
                        <!-- データの種類：ユーザー -->
                        <g transform="translate(430, 180)">
                            <rect width="140" height="30" rx="5" ry="5" fill="white" stroke="#4361ee" stroke-width="1.5"/>
                            <text x="70" y="20" text-anchor="middle" font-family="'Fira Code', monospace" font-size="14">ユーザーデータ</text>
                        </g>
                        
                        <!-- データの種類：投稿 -->
                        <g transform="translate(450, 230)">
                            <rect width="100" height="30" rx="5" ry="5" fill="white" stroke="#4361ee" stroke-width="1.5"/>
                            <text x="50" y="20" text-anchor="middle" font-family="'Fira Code', monospace" font-size="14">投稿データ</text>
                        </g>
                        
                        <!-- データの種類：商品 -->
                        <g transform="translate(430, 280)">
                            <rect width="140" height="30" rx="5" ry="5" fill="white" stroke="#4361ee" stroke-width="1.5"/>
                            <text x="70" y="20" text-anchor="middle" font-family="'Fira Code', monospace" font-size="14">商品データ</text>
                        </g>
                        
                        <!-- フロントエンド -->
                        <rect x="150" y="150" width="150" height="80" rx="10" ry="10" fill="#e3f2fd" stroke="#4361ee" stroke-width="2"/>
                        <text x="225" y="190" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="16" fill="#4361ee">フロントエンド</text>
                        <text x="225" y="210" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">データの表示・入力</text>
                        
                        <!-- バックエンド -->
                        <rect x="150" y="270" width="150" height="80" rx="10" ry="10" fill="#e0f7fa" stroke="#7209b7" stroke-width="2"/>
                        <text x="225" y="310" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="16" fill="#7209b7">バックエンド</text>
                        <text x="225" y="330" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">データの処理・管理</text>
                        
                        <!-- アプリケーション -->
                        <rect x="700" y="150" width="150" height="80" rx="10" ry="10" fill="#fff3e0" stroke="#fca311" stroke-width="2"/>
                        <text x="775" y="180" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="16" fill="#fca311">管理画面</text>
                        <text x="775" y="200" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">データの管理・分析</text>
                        
                        <!-- 外部サービス -->
                        <rect x="700" y="270" width="150" height="80" rx="10" ry="10" fill="#ffccd5" stroke="#f72585" stroke-width="2"/>
                        <text x="775" y="310" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="16" fill="#f72585">外部サービス</text>
                        <text x="775" y="330" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">APIを通じたデータ連携</text>
                        
                        <!-- 接続線 -->
                        <path d="M 300 190 L 350 190 C 380 190, 380 190, 410 190" stroke="#4361ee" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M 300 310 L 350 310 C 380 310, 380 280, 400 270" stroke="#7209b7" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M 650 190 L 680 190 C 690 190, 690 190, 700 190" stroke="#fca311" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        <path d="M 650 310 L 680 310 C 690 310, 690 310, 700 310" stroke="#f72585" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                        
                        <!-- ラベル -->
                        <text x="360" y="175" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">読み取り/表示</text>
                        <text x="360" y="295" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">CRUD操作</text>
                        <text x="655" y="175" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">分析/レポート</text>
                        <text x="655" y="295" font-family="'M PLUS Rounded 1c', sans-serif" font-size="12">データ連携</text>
                        
                        <!-- データベースの用途 -->
                        <rect x="120" y="400" width="220" height="70" rx="10" ry="10" fill="white" stroke="#f72585" stroke-width="2" stroke-dasharray="5,3"/>
                        <text x="230" y="430" text-anchor="middle" font-family="'Caveat', cursive" font-size="18" fill="#f72585">データの永続的な保存</text>
                        <text x="230" y="455" text-anchor="middle" font-family="'Caveat', cursive" font-size="18" fill="#f72585">アプリの状態管理</text>
                        
                        <rect x="390" y="400" width="220" height="70" rx="10" ry="10" fill="white" stroke="#f72585" stroke-width="2" stroke-dasharray="5,3"/>
                        <text x="500" y="430" text-anchor="middle" font-family="'Caveat', cursive" font-size="18" fill="#f72585">効率的なデータ検索</text>
                        <text x="500" y="455" text-anchor="middle" font-family="'Caveat', cursive" font-size="18" fill="#f72585">データの整合性確保</text>
                        
                        <rect x="660" y="400" width="220" height="70" rx="10" ry="10" fill="white" stroke="#f72585" stroke-width="2" stroke-dasharray="5,3"/>
                        <text x="770" y="430" text-anchor="middle" font-family="'Caveat', cursive" font-size="18" fill="#f72585">複数ユーザー間の共有</text>
                        <text x="770" y="455" text-anchor="middle" font-family="'Caveat', cursive" font-size="18" fill="#f72585">バックアップと復元</text>
                        
                        <!-- Arrow definition -->
                        <defs>
                            <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#343a40" />
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
            
            <div class="content-wrapper">
                <aside class="sidebar">
                    <h3 class="sidebar-title">目次</h3>
                    <ul class="sidebar-nav">
                        <li><a href="#db-types">データベースの種類</a></li>
                        <li><a href="#data-modeling">データモデリング</a></li>
                        <li><a href="#db-services">データベースサービス比較</a></li>
                        <li><a href="#crud-operations">基本的なCRUD操作</a></li>
                        <li><a href="#query-optimization">クエリ最適化</a></li>
                        <li><a href="#security">データセキュリティ</a></li>
                        <li><a href="#modeling-examples">モデリング実例</a></li>
                        <li><a href="#claude-tips">Claude活用テクニック</a></li>
                    </ul>
                </aside>
                
                <div class="main-content">
                    <section id="db-types" class="content-section">
                        <h3>データベースの種類</h3>
                        <p>データベースは大きく分けて、リレーショナルデータベース（RDB）とNoSQLデータベースの2種類があります。それぞれに特徴があり、用途に応じて選択します。</p>
                        
                        <div class="feature-grid">
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(67, 97, 238, 0.1); color: #4361ee;">📋</div>
                                <h5 class="feature-title">リレーショナルデータベース（RDB）</h5>
                                <p>テーブル（表）形式でデータを管理し、テーブル間の関係を定義できるデータベース。構造化されたデータに適しています。</p>
                                <p><strong>代表例：</strong> MySQL, PostgreSQL, SQLiteなど</p>
                                <p><strong>特徴：</strong> 厳格なスキーマ、トランザクション処理、結合操作、データの一貫性重視</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(252, 163, 17, 0.1); color: #fca311;">📁</div>
                                <h5 class="feature-title">NoSQLデータベース</h5>
                                <p>非リレーショナルタイプのデータベースで、柔軟なスキーマを持ち、大量データの高速処理に適しています。</p>
                                <p><strong>代表例：</strong> MongoDB, Firebase Firestore, DynamoDBなど</p>
                                <p><strong>特徴：</strong> 柔軟なスキーマ、水平スケーラビリティ、分散処理、開発スピード重視</p>
                            </div>
                        </div>
                        
                        <h4>詳細比較</h4>
                        <div class="comparison-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>観点</th>
                                        <th>リレーショナルDB</th>
                                        <th>NoSQL DB</th>
                                        <th>非エンジニアにとっての意味</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>データ構造</td>
                                        <td>テーブル（行と列）</td>
                                        <td>ドキュメント、キーバリュー、グラフなど</td>
                                        <td>RDBは表計算ソフトのような構造、NoSQLはJSON的な階層構造</td>
                                    </tr>
                                    <tr>
                                        <td>スキーマ</td>
                                        <td>固定（事前定義）</td>
                                        <td>柔軟（随時変更可能）</td>
                                        <td>NoSQLは途中で項目追加が容易</td>
                                    </tr>
                                    <tr>
                                        <td>関連データ</td>
                                        <td>外部キーによる関連付け</td>
                                        <td>埋め込みまたは参照</td>
                                        <td>RDBはExcelの「VLOOKUP」的な関連付け、NoSQLは階層的に含める</td>
                                    </tr>
                                    <tr>
                                        <td>クエリ言語</td>
                                        <td>SQL（標準化）</td>
                                        <td>データベースごとに異なる</td>
                                        <td>RDBはSQL学習が必要、NoSQLはJavaScriptライクな操作が多い</td>
                                    </tr>
                                    <tr>
                                        <td>トランザクション</td>
                                        <td>強力なサポート</td>
                                        <td>限定的なサポート</td>
                                        <td>複数操作の一貫性が重要な場合はRDBが有利</td>
                                    </tr>
                                    <tr>
                                        <td>スケーラビリティ</td>
                                        <td>垂直（より強力なサーバー）</td>
                                        <td>水平（より多くのサーバー）</td>
                                        <td>大規模データを扱う場合、NoSQLの方がコスト効率良く拡張可能</td>
                                    </tr>
                                    <tr>
                                        <td>学習曲線</td>
                                        <td>中～高（SQL習得が必要）</td>
                                        <td>低～中（JSONライクな操作）</td>
                                        <td>非エンジニアには一般的にNoSQLの方が取り組みやすい</td>
                                    </tr>
                                    <tr>
                                        <td>最適な用途</td>
                                        <td>構造化データ、複雑な検索、トランザクション</td>
                                        <td>半構造化データ、高速読み書き、柔軟な拡張</td>
                                        <td>小～中規模のWebサービスならNoSQLで十分な場合が多い</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="tip">
                            <h4>💡 選択のポイント</h4>
                            <p>非エンジニアがWebサービスを開発する場合、<strong>NoSQLデータベース特にFirebase FirestoreやSupabase</strong>の方が取り組みやすいことが多いです。理由は以下の通りです：</p>
                            <ul>
                                <li>柔軟なスキーマで途中での項目追加が容易</li>
                                <li>SQLの習得が不要</li>
                                <li>JavaScriptとの親和性が高く、フロントエンドとの連携が容易</li>
                                <li>クラウドサービスとして提供されるため、インフラ管理が不要</li>
                                <li>認証などの周辺機能も統合されていることが多い</li>
                            </ul>
                            <p>ただし、データ間の複雑な関係や整合性が重要な場合は、リレーショナルDBが適している場合もあります。</p>
                        </div>
                    </section>
                    
                    <section id="data-modeling" class="content-section">
                        <h3>データモデリングの基本</h3>
                        <p>データモデリングとは、サービスで扱うデータの構造や関係を設計することです。適切なデータモデリングは、効率的なデータ操作、パフォーマンス向上、アプリケーションの拡張性に直結します。</p>
                        
                        <div class="gr-container">
                            <h3 class="gr-title">データモデリングのプロセス</h3>
                            <div class="gr-content">
                                <svg viewBox="0 0 1000 400" width="100%" height="auto">
                                    <!-- 背景グリッド -->
                                    <defs>
                                        <pattern id="smallGrid2" width="10" height="10" patternUnits="userSpaceOnUse">
                                            <path d="M 10 0 L 0 0 0 10" fill="none" stroke="#f0f0f0" stroke-width="0.5"/>
                                        </pattern>
                                        <pattern id="grid2" width="100" height="100" patternUnits="userSpaceOnUse">
                                            <rect width="100" height="100" fill="url(#smallGrid2)"/>
                                            <path d="M 100 0 L 0 0 0 100" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                                        </pattern>
                                    </defs>
                                    <rect width="100%" height="100%" fill="url(#grid2)" />
                                    
                                    <!-- ステップ1: 要件分析 -->
                                    <rect x="100" y="80" width="200" height="100" rx="10" ry="10" fill="#e3f2fd" stroke="#4361ee" stroke-width="2"/>
                                    <text x="200" y="120" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="18" fill="#4361ee">1. 要件分析</text>
                                    <text x="200" y="145" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">何のデータを保存するか</text>
                                    <text x="200" y="165" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">どう使われるか</text>
                                    
                                    <!-- ステップ2: エンティティ特定 -->
                                    <rect x="400" y="80" width="200" height="100" rx="10" ry="10" fill="#fff3e0" stroke="#fca311" stroke-width="2"/>
                                    <text x="500" y="120" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="18" fill="#fca311">2. エンティティ特定</text>
                                    <text x="500" y="145" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">主要なデータ要素は何か</text>
                                    <text x="500" y="165" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">ユーザー、投稿、商品など</text>
                                    
                                    <!-- ステップ3: 関係定義 -->
                                    <rect x="700" y="80" width="200" height="100" rx="10" ry="10" fill="#e0f7fa" stroke="#7209b7" stroke-width="2"/>
                                    <text x="800" y="120" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="18" fill="#7209b7">3. 関係定義</text>
                                    <text x="800" y="145" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">エンティティ間の関連</text>
                                    <text x="800" y="165" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">1対多、多対多など</text>
                                    
                                    <!-- ステップ4: 属性定義 -->
                                    <rect x="100" y="230" width="200" height="100" rx="10" ry="10" fill="#ffccd5" stroke="#f72585" stroke-width="2"/>
                                    <text x="200" y="270" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="18" fill="#f72585">4. 属性定義</text>
                                    <text x="200" y="295" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">各エンティティの特性</text>
                                    <text x="200" y="315" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">名前、年齢、価格など</text>
                                    
                                    <!-- ステップ5: スキーマ設計 -->
                                    <rect x="400" y="230" width="200" height="100" rx="10" ry="10" fill="#c9f7f5" stroke="#2a9d8f" stroke-width="2"/>
                                    <text x="500" y="270" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="18" fill="#2a9d8f">5. スキーマ設計</text>
                                    <text x="500" y="295" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">データ構造の詳細化</text>
                                    <text x="500" y="315" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">型、制約、インデックス</text>
                                    
                                    <!-- ステップ6: 最適化 -->
                                    <rect x="700" y="230" width="200" height="100" rx="10" ry="10" fill="#f0f4c3" stroke="#606c38" stroke-width="2"/>
                                    <text x="800" y="270" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="18" fill="#606c38">6. 最適化</text>
                                    <text x="800" y="295" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">クエリパターンに合わせる</text>
                                    <text x="800" y="315" text-anchor="middle" font-family="'M PLUS Rounded 1c', sans-serif" font-size="14">パフォーマンス向上</text>
                                    
                                    <!-- 接続線 -->
                                    <path d="M 300 130 L 380 130" stroke="#343a40" stroke-width="2" marker-end="url(#arrow2)"/>
                                    <path d="M 600 130 L 680 130" stroke="#343a40" stroke-width="2" marker-end="url(#arrow2)"/>
                                    <path d="M 800 180 L 800 200 C 800 210, 500 210, 200 210 C 200 210, 200 220, 200 230" stroke="#343a40" stroke-width="2" marker-end="url(#arrow2)"/>
                                    <path d="M 300 280 L 380 280" stroke="#343a40" stroke-width="2" marker-end="url(#arrow2)"/>
                                    <path d="M 600 280 L 680 280" stroke="#343a40" stroke-width="2" marker-end="url(#arrow2)"/>
                                    
                                    <!-- Arrow definition -->
                                    <defs>
                                        <marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                            <path d="M0,0 L0,6 L9,3 z" fill="#343a40" />
                                        </marker>
                                    </defs>
                                </svg>
                            </div>
                        </div>
                        
                        <h4>リレーショナルデータベースのモデリング</h4>
                        <p>リレーショナルデータベースでは、テーブル間の関係を定義することが重要です。主要な関係タイプには以下があります：</p>
                        
                        <div class="feature-grid">
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(67, 97, 238, 0.1); color: #4361ee;">1️⃣</div>
                                <h5 class="feature-title">1対1の関係</h5>
                                <p>一方のテーブルのレコードが、他方のテーブルの1つのレコードだけに関連付けられる関係。</p>
                                <p><strong>例：</strong> ユーザーとユーザープロフィール、社員と社員証など</p>
                                <p>通常は、外部キーを使って関連付けるか、同じテーブルに統合します。</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(252, 163, 17, 0.1); color: #fca311;">🔢</div>
                                <h5 class="feature-title">1対多の関係</h5>
                                <p>一方のテーブルのレコードが、他方のテーブルの複数レコードに関連付けられる関係。</p>
                                <p><strong>例：</strong> ユーザーと投稿（1人のユーザーが複数の投稿）、カテゴリと商品など</p>
                                <p>「多」側のテーブルに外部キーを追加して、「1」側のテーブルの主キーを参照します。</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(247, 37, 133, 0.1); color: #f72585;">🔄</div>
                                <h5 class="feature-title">多対多の関係</h5>
                                <p>両方のテーブルのレコードが、相互に複数のレコードに関連付けられる関係。</p>
                                <p><strong>例：</strong> 学生と講座（1人の学生が複数の講座、1つの講座に複数の学生）、タグと記事など</p>
                                <p>中間テーブル（結合テーブル）を作成し、両方のテーブルの主キーを外部キーとして持たせます。</p>
                            </div>
                        </div>
                        
                        <h4>NoSQLデータベースのモデリング</h4>
                        <p>NoSQLデータベース（特にドキュメント指向のFirestoreなど）では、データアクセスパターンに基づいてモデリングします。主要な設計パターンは以下の通りです：</p>
                        
                        <div class="feature-grid">
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(67, 97, 238, 0.1); color: #4361ee;">📄</div>
                                <h5 class="feature-title">埋め込みパターン</h5>
                                <p>関連データを単一のドキュメント内に埋め込む方法。</p>
                                <p><strong>例：</strong> ユーザードキュメント内に住所情報を埋め込む、投稿にコメントを埋め込むなど</p>
                                <p><strong>メリット：</strong> 単一クエリで全データ取得可能、一貫性が保てる</p>
                                <p><strong>デメリット：</strong> データ重複の可能性、ドキュメントサイズ制限（通常1MB前後）</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(252, 163, 17, 0.1); color: #fca311;">🔗</div>
                                <h5 class="feature-title">参照パターン</h5>
                                <p>別のドキュメントへの参照（ID）を保存する方法。RDBの外部キーに近い概念。</p>
                                <p><strong>例：</strong> 投稿ドキュメントに著者IDを保存、コメントに投稿IDを保存など</p>
                                <p><strong>メリット：</strong> データ重複を避けられる、大きなデータセットに適している</p>
                                <p><strong>デメリット：</strong> 複数クエリが必要、結合操作がない場合がある</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(76, 201, 240, 0.1); color: #4cc9f0;">📊</div>
                                <h5 class="feature-title">非正規化パターン</h5>
                                <p>データを複数の場所に複製して保存する方法。クエリの効率化が目的。</p>
                                <p><strong>例：</strong> ユーザー情報を投稿ドキュメントにも保存、頻繁にアクセスされる集計データを別途保存など</p>
                                <p><strong>メリット：</strong> クエリパフォーマンスの向上、複雑な計算の回避</p>
                                <p><strong>デメリット：</strong> データ整合性の維持が難しい、更新時の複雑さ</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(247, 37, 133, 0.1); color: #f72585;">🌲</div>
                                <h5 class="feature-title">コレクション/サブコレクション</h5>
                                <p>Firestoreなどで階層構造を作る方法。パスベースでアクセスできる。</p>
                                <p><strong>例：</strong> users/{userId}/posts/{postId} のように、ユーザーのサブコレクションとして投稿を保存</p>
                                <p><strong>メリット：</strong> 論理的な階層表現、アクセス制御が容易</p>
                                <p><strong>デメリット：</strong> 全サブコレクション横断のクエリが難しい場合がある</p>
                            </div>
                        </div>
                        
                        <div class="notes">
                            <h4>📝 NoSQLモデリングの重要ポイント</h4>
                            <p>NoSQLデータベースでは、「どのようにデータを取得するか」を最初に考えることが重要です。クエリパターンに基づいてデータ構造を設計します。</p>
                            <ol>
                                <li><strong>クエリファースト</strong>: まずアプリケーションがどのようなクエリを必要とするかを明確にする</li>
                                <li><strong>読み取り最適化</strong>: 読み取りパターンに合わせてデータを構造化（特にFirestoreなどでは読み取りコストが高い）</li>
                                <li><strong>適切なバランス</strong>: 埋め込み、参照、非正規化をケースに応じて使い分ける</li>
                                <li><strong>将来の拡張性</strong>: データ量やアクセスパターンの変化を考慮する</li>
                            </ol>
                        </div>
                    </section>
                    
                    <section id="db-services" class="content-section">
                        <h3>データベースサービス比較</h3>
                        <p>非エンジニアが取り組みやすい主要なデータベースサービスを比較します。サーバー管理が不要なマネージドサービスを中心に紹介します。</p>
                        
                        <div class="service-card" style="background-color: rgba(255, 220, 178, 0.2);">
                            <div class="service-icon" style="background-color: #ffdc9e; color: #f57c00;">
                                🔥
                            </div>
                            <div class="service-content">
                                <h5 class="service-title">Firebase Firestore</h5>
                                <p>Googleが提供するクラウドベースのNoSQLドキュメントデータベース。リアルタイム更新、オフライン対応、セキュリティルールなどの機能を備えています。</p>
                                <p><strong>良い点：</strong> 簡単な導入、リアルタイム機能、認証などの統合サービス、無料枠が寛大</p>
                                <p><strong>課題：</strong> 複雑なクエリや結合操作が制限される、スケールに応じてコストが上昇</p>
                                <p><strong>最適な用途：</strong> リアルタイム性が重要なアプリ、プロトタイプ開発、中規模までのサービス</p>
                            </div>
                        </div>
                        
                        <div class="service-card" style="background-color: rgba(178, 235, 242, 0.2);">
                            <div class="service-icon" style="background-color: #b2ebf2; color: #00acc1;">
                                🔶
                            </div>
                            <div class="service-content">
                                <h5 class="service-title">Supabase</h5>
                                <p>オープンソースのFirebase代替サービス。PostgreSQLをベースにしており、リレーショナルデータベースとNoSQLの利点を組み合わせています。</p>
                                <p><strong>良い点：</strong> SQL機能とリアルタイム機能の両立、リレーショナルデータベースの強み、オープンソース</p>
                                <p><strong>課題：</strong> 比較的新しいサービスで、ドキュメントや事例がFirebaseより少ない</p>
                                <p><strong>最適な用途：</strong> 構造化データと関係性が重要なアプリ、SQLに慣れている開発者</p>
                            </div>
                        </div>
                        
                        <div class="service-card" style="background-color: rgba(225, 190, 231, 0.2);">
                            <div class="service-icon" style="background-color: #e1bee7; color: #8e24aa;">
                                🍃
                            </div>
                            <div class="service-content">
                                <h5 class="service-title">MongoDB Atlas</h5>
                                <p>MongoDBのクラウドサービス版。柔軟なドキュメント構造と豊富なクエリ機能を提供するNoSQLデータベースです。</p>
                                <p><strong>良い点：</strong> 強力なクエリ機能、スケーラビリティ、フルマネージド、無料枠あり</p>
                                <p><strong>課題：</strong> Firebaseより設定が複雑、認証機能などは別途用意する必要あり</p>
                                <p><strong>最適な用途：</strong> 柔軟なスキーマと強力なクエリ機能が必要なアプリ、成長を見込むサービス</p>
                            </div>
                        </div>
                        
                        <div class="service-card" style="background-color: rgba(201, 247, 245, 0.2);">
                            <div class="service-icon" style="background-color: #c9f7f5; color: #2a9d8f;">
                                📚
                            </div>
                            <div class="service-content">
                                <h5 class="service-title">PlanetScale</h5>
                                <p>MySQLをベースにしたサーバーレスデータベースプラットフォーム。開発者フレンドリーなインターフェースとスケーラビリティを提供します。</p>
                                <p><strong>良い点：</strong> リレーショナルDBの強み、高スケーラビリティ、ブランチ機能、無料枠あり</p>
                                <p><strong>課題：</strong> リアルタイム機能がない、設定がやや複雑</p>
                                <p><strong>最適な用途：</strong> データの関係性が重要なアプリ、トランザクション処理が必要なサービス</p>
                            </div>
                        </div>
                        
                        <div class="service-card" style="background-color: rgba(230, 230, 230, 0.2);">
                            <div class="service-icon" style="background-color: #e6e6e6; color: #212529;">
                                ☁️
                            </div>
                            <div class="service-content">
                                <h5 class="service-title">Amazon DynamoDB</h5>
                                <p>AWSが提供するフルマネージドNoSQLデータベースサービス。高パフォーマンスと高可用性が特徴です。</p>
                                <p><strong>良い点：</strong> 高スケーラビリティ、低レイテンシ、従量課金制、AWSサービスとの統合</p>
                                <p><strong>課題：</strong> 学習曲線が高い、クエリの制限、料金体系が複雑</p>
                                <p><strong>最適な用途：</strong> 高負荷アプリケーション、IoTデータ、大規模Webサービス</p>
                            </div>
                        </div>
                        
                        <div class="tip">
                            <h4>💡 非エンジニアへのおすすめ</h4>
                            <p>初めてのWebサービス開発では、<strong>Firebase Firestore</strong>か<strong>Supabase</strong>から始めることをおすすめします。どちらもユーザーフレンドリーなインターフェースを提供し、認証や基本的なバックエンド機能が統合されているため、素早く開発を進められます。</p>
                            <p>特に、リアルタイム機能や頻繁なスキーマ変更を考えているなら<strong>Firebase</strong>、データの関係性が重要ならテーブル構造を持つ<strong>Supabase</strong>が適しています。</p>
                        </div>
                    </section>
                    
                    <section id="crud-operations" class="content-section">
                        <h3>基本的なCRUD操作</h3>
                        <p>データベース操作の基本は「CRUD」（Create, Read, Update, Delete）と呼ばれる4つの操作です。よく使用されるFirebase Firestoreを例に、これらの操作方法を説明します。</p>
                        
                        <div class="steps-container">
                            <div class="step-item">
                                <div class="step-number">C</div>
                                <div class="step-content">
                                    <h5 class="step-title">Create（作成）</h5>
                                    <p>新しいデータをデータベースに追加する操作です。</p>
                                    <div class="code-block" data-language="JavaScript">
// Firestoreのセットアップ
import { initializeApp } from 'firebase/app';
import { getFirestore, collection, addDoc, setDoc, doc } from 'firebase/firestore';

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// 新しいドキュメントを追加（自動ID生成）
async function createUser(userData) {
  try {
    const docRef = await addDoc(collection(db, "users"), {
      name: userData.name,
      email: userData.email,
      createdAt: new Date()
    });
    
    console.log("ドキュメントが追加されました。ID: ", docRef.id);
    return docRef.id;
  } catch (error) {
    console.error("ドキュメント追加エラー: ", error);
    throw error;
  }
}

// IDを指定して新しいドキュメントを作成または上書き
async function createUserWithId(userId, userData) {
  try {
    await setDoc(doc(db, "users", userId), {
      name: userData.name,
      email: userData.email,
      createdAt: new Date()
    });
    
    console.log("ドキュメントが作成/更新されました。ID: ", userId);
    return userId;
  } catch (error) {
    console.error("ドキュメント作成/更新エラー: ", error);
    throw error;
  }
}
                                    </div>
                                    <div class="tip">
                                        <h4>💡 ヒント</h4>
                                        <p><code>addDoc</code>はFirestoreが自動的にユニークなIDを生成します。特定のIDを使いたい場合は<code>setDoc</code>と<code>doc</code>を組み合わせて使用します。</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">R</div>
                                <div class="step-content">
                                    <h5 class="step-title">Read（読み取り）</h5>
                                    <p>データベースからデータを取得する操作です。単一のドキュメント取得と複数ドキュメント取得の両方があります。</p>
                                    <div class="code-block" data-language="JavaScript">
import { getDoc, getDocs, collection, doc, query, where, orderBy, limit } from 'firebase/firestore';

// 単一のドキュメントを取得
async function getUser(userId) {
  try {
    const docRef = doc(db, "users", userId);
    const docSnap = await getDoc(docRef);
    
    if (docSnap.exists()) {
      console.log("ドキュメントデータ:", docSnap.data());
      return { id: docSnap.id, ...docSnap.data() };
    } else {
      console.log("ドキュメントが見つかりません");
      return null;
    }
  } catch (error) {
    console.error("ドキュメント取得エラー: ", error);
    throw error;
  }
}

// コレクション内のすべてのドキュメントを取得
async function getAllUsers() {
  try {
    const querySnapshot = await getDocs(collection(db, "users"));
    const users = [];
    
    querySnapshot.forEach((doc) => {
      users.push({ id: doc.id, ...doc.data() });
    });
    
    console.log("取得したユーザー:", users);
    return users;
  } catch (error) {
    console.error("ドキュメント一覧取得エラー: ", error);
    throw error;
  }
}

// 条件付きクエリ
async function queryUsers(minAge, city, limit) {
  try {
    const q = query(
      collection(db, "users"),
      where("age", ">=", minAge),
      where("city", "==", city),
      orderBy("age", "desc"),
      limit(limit)
    );
    
    const querySnapshot = await getDocs(q);
    const users = [];
    
    querySnapshot.forEach((doc) => {
      users.push({ id: doc.id, ...doc.data() });
    });
    
    return users;
  } catch (error) {
    console.error("クエリエラー: ", error);
    throw error;
  }
}
                                    </div>
                                    <div class="notes">
                                        <h4>📝 クエリの制限</h4>
                                        <p>Firestoreでは複合クエリに制限があります。複合インデックスの作成が必要な場合や、特定の条件を組み合わせられない場合があるので注意してください。</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">U</div>
                                <div class="step-content">
                                    <h5 class="step-title">Update（更新）</h5>
                                    <p>既存のデータを変更する操作です。特定のフィールドだけを更新することも可能です。</p>
                                    <div class="code-block" data-language="JavaScript">
import { updateDoc, doc } from 'firebase/firestore';

// ドキュメントの特定フィールドを更新
async function updateUser(userId, userData) {
  try {
    const userRef = doc(db, "users", userId);
    
    await updateDoc(userRef, {
      name: userData.name,
      email: userData.email,
      updatedAt: new Date()
    });
    
    console.log("ドキュメントが更新されました");
    return userId;
  } catch (error) {
    console.error("ドキュメント更新エラー: ", error);
    throw error;
  }
}

// フィールドの増分更新
async function incrementUserPoints(userId, points) {
  try {
    const userRef = doc(db, "users", userId);
    
    await updateDoc(userRef, {
      points: increment(points),
      updatedAt: new Date()
    });
    
    console.log("ポイントが更新されました");
    return userId;
  } catch (error) {
    console.error("ポイント更新エラー: ", error);
    throw error;
  }
}
                                    </div>
                                    <div class="tip">
                                        <h4>💡 ヒント</h4>
                                        <p><code>updateDoc</code>は指定されたフィールドのみを更新し、他のフィールドはそのまま保持されます。ドキュメント全体を置き換えたい場合は<code>setDoc</code>を使用します。</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="step-item">
                                <div class="step-number">D</div>
                                <div class="step-content">
                                    <h5 class="step-title">Delete（削除）</h5>
                                    <p>データを削除する操作です。ドキュメント全体の削除と特定フィールドの削除があります。</p>
                                    <div class="code-block" data-language="JavaScript">
import { deleteDoc, doc, updateDoc, deleteField } from 'firebase/firestore';

// ドキュメント全体を削除
async function deleteUser(userId) {
  try {
    await deleteDoc(doc(db, "users", userId));
    
    console.log("ドキュメントが削除されました");
    return userId;
  } catch (error) {
    console.error("ドキュメント削除エラー: ", error);
    throw error;
  }
}

// 特定のフィールドのみを削除
async function removeUserField(userId, fieldName) {
  try {
    const userRef = doc(db, "users", userId);
    
    // フィールド削除の更新操作
    await updateDoc(userRef, {
      [fieldName]: deleteField()
    });
    
    console.log(`${fieldName}フィールドが削除されました`);
    return userId;
  } catch (error) {
    console.error("フィールド削除エラー: ", error);
    throw error;
  }
}
                                    </div>
                                    <div class="notes">
                                        <h4>📝 注意点</h4>
                                        <p>データを削除する際は、関連するデータも適切に処理することが重要です。例えば、ユーザーを削除する場合、そのユーザーの投稿やコメントも削除するかどうかを検討する必要があります。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h4>Firestoreでのリアルタイム更新</h4>
                        <p>Firestoreの大きな特徴の一つが、リアルタイムアップデートの仕組みです。データが変更されると、リスナーを通じてアプリにリアルタイムで通知されます。</p>
                        
                        <div class="code-block" data-language="JavaScript">
import { onSnapshot, doc, collection, query, where } from 'firebase/firestore';

// 単一ドキュメントのリアルタイム監視
function listenToUser(userId, callback) {
  const userRef = doc(db, "users", userId);
  
  // リスナーの設定（返り値はリスナーの解除関数）
  const unsubscribe = onSnapshot(userRef, (doc) => {
    if (doc.exists()) {
      console.log("現在のデータ:", doc.data());
      callback({ id: doc.id, ...doc.data() });
    } else {
      console.log("ドキュメントが存在しません");
      callback(null);
    }
  }, (error) => {
    console.error("リスナーエラー:", error);
  });
  
  // リスナー解除用の関数を返す
  return unsubscribe;
}

// クエリに基づくリアルタイム監視
function listenToActiveUsers(callback) {
  const q = query(
    collection(db, "users"),
    where("status", "==", "active")
  );
  
  const unsubscribe = onSnapshot(q, (querySnapshot) => {
    const users = [];
    querySnapshot.forEach((doc) => {
      users.push({ id: doc.id, ...doc.data() });
    });
    
    console.log("アクティブユーザー:", users);
    callback(users);
  });
  
  return unsubscribe;
}

// 使用例
const unsubscribeUser = listenToUser("user123", (userData) => {
  // ユーザーデータが変更されるたびに呼ばれる
  updateUserInterface(userData);
});

// リスナーの解除（コンポーネントのアンマウント時などに）
unsubscribeUser();
                        </div>
                        
                        <div class="tip">
                            <h4>💡 リアルタイム更新の活用シーン</h4>
                            <p>リアルタイム更新は以下のようなケースで特に役立ちます：</p>
                            <ul>
                                <li>チャットアプリなどのメッセージ表示</li>
                                <li>複数ユーザーが同時編集するドキュメント</li>
                                <li>リアルタイム通知システム</li>
                                <li>ライブデータダッシュボード</li>
                                <li>オンラインステータスの表示</li>
                            </ul>
                            <p>ただし、大量のリアルタイムリスナーはパフォーマンスとコストに影響することがあるため、必要な場合に適切に使用しましょう。</p>
                        </div>
                    </section>
                    
                    <section id="query-optimization" class="content-section">
                        <h3>クエリ最適化</h3>
                        <p>データベースのパフォーマンスを向上させ、コストを削減するためには、クエリの最適化が重要です。特にFirebaseのようなクラウドサービスでは、クエリの効率性がコストに直結します。</p>
                        
                        <div class="feature-grid">
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(67, 97, 238, 0.1); color: #4361ee;">🔍</div>
                                <h5 class="feature-title">インデックスの活用</h5>
                                <p>インデックスはデータベースのクエリパフォーマンスを大幅に向上させる仕組みです。特に検索条件や並べ替えで使われるフィールドにインデックスを設定しましょう。</p>
                                <p><strong>Firestoreの場合：</strong> 単一フィールドのインデックスは自動的に作成されますが、複合クエリ（複数の条件や並べ替え）には複合インデックスの設定が必要です。</p>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(252, 163, 17, 0.1); color: #fca311;">⚡</div>
                                <h5 class="feature-title">クエリの絞り込み</h5>
                                <p>必要最小限のデータだけを取得するようにクエリを設計しましょう。大量のデータをクライアントに取得してから絞り込むのは非効率です。</p>
                                <p><strong>主な手法：</strong></p>
                                <ul>
                                    <li><code>where</code>条件を使って必要なデータだけをフィルタリング</li>
                                    <li><code>limit</code>を使って結果数を制限（ページネーション）</li>
                                    <li>必要なフィールドだけを取得（Firestoreでは現在制限あり）</li>
                                </ul>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(76, 201, 240, 0.1); color: #4cc9f0;">🔄</div>
                                <h5 class="feature-title">データ構造の最適化</h5>
                                <p>クエリパターンに合わせてデータ構造を設計することが、最も効果的な最適化です。頻繁に一緒に取得されるデータは、埋め込みや非正規化を検討しましょう。</p>
                                <p><strong>例：</strong></p>
                                <ul>
                                    <li>ユーザープロフィールと一緒に表示されるデータを埋め込む</li>
                                    <li>検索や集計に使われるデータを別途集計し保存</li>
                                    <li>頻繁にアクセスされる情報を複数の場所に複製</li>
                                </ul>
                            </div>
                            
                            <div class="feature-card">
                                <div class="feature-icon" style="background-color: rgba(247, 37, 133, 0.1); color: #f72585;">📊</div>
                                <h5 class="feature-title">バッチ処理と集約</h5>
                                <p>大量のデータ操作が必要な場合、バッチ処理を利用して効率化しましょう。また、集計やレポートなどは事前計算して保存することを検討してください。</p>
                                <p><strong>Firestoreの場合：</strong></p>
                                <ul>
                                    <li><code>writeBatch</code>を使って複数の書き込みを一度に実行</li>
                                    <li>カウンターや集計値を更新する際はトランザクションを使用</li>
                                    <li>大量データの場合はCloud Functionsでバックグラウンド処理</li>
                                </ul>
                            </div>
                        </div>
                        
                        <h4>Firestoreパフォーマンス最適化の実例</h4>
                        <div class="code-block" data-language="JavaScript">
import { 
  writeBatch, 
  increment, 
  arrayUnion, 
  arrayRemove,
  query,
  where,
  orderBy,
  limit,
  startAfter,
  endBefore,
  startAt,
  endAt
} from 'firebase/firestore';

// バッチ処理の例（複数の操作を一度に実行）
async function batchUpdateUsers(userUpdates) {
  try {
    const batch = writeBatch(db);
    
    userUpdates.forEach(update => {
      const userRef = doc(db, "users", update.userId);
      batch.update(userRef, {
        status: update.status,
        updatedAt: new Date()
      });
    });
    
    await batch.commit();
    console.log("バッチ更新が完了しました");
  } catch (error) {
    console.error("バッチ更新エラー:", error);
    throw error;
  }
}

// 特殊フィールド値の使用例
async function updateUserData(userId, newTag) {
  try {
    const userRef = doc(db, "users", userId);
    
    await updateDoc(userRef, {
      // カウンターの増加（アトミック操作）
      visitCount: increment(1),
      
      // 配列への追加
      tags: arrayUnion(newTag),
      
      // 配列からの削除
      removedTags: arrayRemove('oldTag'),
      
      updatedAt: new Date()
    });
    
    console.log("ユーザーデータが更新されました");
  } catch (error) {
    console.error("更新エラー:", error);
    throw error;
  }
}

// ページネーションの実装例
async function getPaginatedUsers(pageSize, lastDocSnapshot = null) {
  try {
    let userQuery = query(
      collection(db, "users"),
      orderBy("createdAt", "desc"),
      limit(pageSize)
    );
    
    // 前回の最後のドキュメント以降を取得（次のページ）
    if (lastDocSnapshot) {
      userQuery = query(
        userQuery,
        startAfter(lastDocSnapshot)
      );
    }
    
    const querySnapshot = await getDocs(userQuery);
    const users = [];
    
    querySnapshot.forEach(doc => {
      users.push({ id: doc.id, ...doc.data() });
    });
    
    // 次のページのためのlastDocumentを返す
    const lastVisible = querySnapshot.docs[querySnapshot.docs.length - 1];
    
    return {
      users,
      lastVisible
    };
  } catch (error) {
    console.error("ページネーションエラー:", error);
    throw error;
  }
}

// 使用例（ページネーション）
async function loadUserPages() {
  // 最初のページ（10件）
  const page1 = await getPaginatedUsers(10);
  displayUsers(page1.users);
  
  // 「次へ」ボタンがクリックされたら次のページを読み込む
  nextButton.addEventListener('click', async () => {
    const nextPage = await getPaginatedUsers(10, page1.lastVisible);
    displayUsers(nextPage.users);
  });
}
                        </div>
                        
                        <div class="notes">
                            <h4>📝 Firestoreでのクエリ制限</h4>
                            <p>Firestoreには以下のようなクエリの制限があります。これらを考慮したデータモデリングが重要です：</p>
                            <ul>
                                <li>「!=」や「NOT IN」などの否定演算子が使えない</li>
                                <li>「OR」条件がない（複数のクエリを実行して結果を結合する必要がある）</li>
                                <li>異なるフィールドに対する範囲クエリ（>、<）が使えない</li>
                                <li>コレクション全体を横断するサブコレクションのクエリができない</li>
                                <li>結合操作（JOIN）がない</li>
                            </ul>
                            <p>これらの制限を回避するには、データの非正規化や目的に合わせたデータ構造の設計が必要です。</p>
                        </div>
                    </section>
                    
                    <section id="
